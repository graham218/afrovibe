<!DOCTYPE html>
<html lang="en" data-theme="afrovibe">
  <%- include('partials/head.ejs', { pageTitle: 'Edit Profile' }) %>
  <body class="bg-base-100 min-h-screen flex flex-col">
    <%- include('partials/navbar.ejs') %>

    <main class="container mx-auto px-4 sm:px-6 md:px-8 py-6 flex-1">
      <header class="mb-5">
        <h1 class="text-2xl md:text-3xl font-bold">Edit profile</h1>
        <p class="text-sm opacity-70">Update your details. Changes appear on your public profile.</p>
      </header>

      <form action="/edit-profile" method="post" class="space-y-6">
        <!-- Basics -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-4">
            <h2 class="card-title md:col-span-2">Basics</h2>

            <label class="form-control">
              <span class="label-text">Username</span>
              <input name="username" class="input input-bordered" value="<%- currentUser?.username || '' %>" required>
            </label>

            <label class="form-control">
              <span class="label-text">Age</span>
              <input name="age" type="number" min="18" max="100" class="input input-bordered" value="<%- currentUser?.profile?.age || '' %>">
            </label>

            <label class="form-control">
              <span class="label-text">Gender</span>
              <input name="gender" class="input input-bordered" value="<%- currentUser?.profile?.gender || '' %>">
            </label>

            <label class="form-control md:col-span-2">
              <span class="label-text">Bio</span>
              <textarea name="bio" rows="4" class="textarea textarea-bordered"><%- currentUser?.profile?.bio || '' %></textarea>
            </label>
          </div>
        </section>

        <!-- Location -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Location</h2>

            <label class="form-control">
              <span class="label-text">Country</span>
              <input name="country" class="input input-bordered" value="<%- currentUser?.profile?.country || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">State/Province</span>
              <input name="stateProvince" class="input input-bordered" value="<%- currentUser?.profile?.stateProvince || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">City</span>
              <input name="city" class="input input-bordered" value="<%- currentUser?.profile?.city || '' %>">
            </label>
          </div>
        </section>

        <!-- Work & Education -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Work & education</h2>

            <label class="form-control">
              <span class="label-text">Occupation</span>
              <input name="occupation" class="input input-bordered" value="<%- currentUser?.profile?.occupation || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Employment status</span>
              <input name="employmentStatus" class="input input-bordered" value="<%- currentUser?.profile?.employmentStatus || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Education level</span>
              <input name="educationLevel" class="input input-bordered" value="<%- currentUser?.profile?.educationLevel || '' %>">
            </label>
          </div>
        </section>

        <!-- Background -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Background</h2>

            <label class="form-control">
              <span class="label-text">Nationality</span>
              <input name="nationality" class="input input-bordered" value="<%- currentUser?.profile?.nationality || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Religion</span>
              <input name="religion" class="input input-bordered" value="<%- currentUser?.profile?.religion || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Star sign</span>
              <input name="starSign" class="input input-bordered" value="<%- currentUser?.profile?.starSign || '' %>">
            </label>

            <label class="form-control md:col-span-3">
              <span class="label-text">Languages (comma separated)</span>
              <input name="languagesSpoken" class="input input-bordered"
                     value="<%- (currentUser?.profile?.languagesSpoken || currentUser?.profile?.languages || []).join(', ') %>">
            </label>
          </div>
        </section>

        <!-- Lifestyle -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Lifestyle</h2>

            <label class="form-control">
              <span class="label-text">Drinks</span>
              <input name="drinks" class="input input-bordered" value="<%- currentUser?.profile?.drinks || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Smokes</span>
              <input name="smokes" class="input input-bordered" value="<%- currentUser?.profile?.smokes || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Pets (comma separated)</span>
              <input name="pets" class="input input-bordered" value="<%- (currentUser?.profile?.pets || []).join(', ') %>">
            </label>

            <label class="form-control md:col-span-3">
              <span class="label-text">Body art (comma separated)</span>
              <input name="bodyArt" class="input input-bordered" value="<%- (currentUser?.profile?.bodyArt || []).join(', ') %>">
            </label>
          </div>
        </section>

        <!-- Relationship & family -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Relationship & family</h2>

            <label class="form-control md:col-span-3">
              <span class="label-text">Looking for (comma separated)</span>
              <input name="relationshipLookingFor" class="input input-bordered"
                     value="<%- (currentUser?.profile?.relationshipLookingFor || []).join(', ') %>">
            </label>

            <label class="form-control">
              <span class="label-text">Children</span>
              <input name="children" class="input input-bordered" value="<%- currentUser?.profile?.children || '' %>">
            </label>
            <label class="form-control">
              <span class="label-text">Wants more children</span>
              <input name="wantsMoreChildren" class="input input-bordered" value="<%- currentUser?.profile?.wantsMoreChildren || '' %>">
            </label>
          </div>
        </section>

        <!-- Interests -->
        <section class="card bg-base-100 shadow">
          <div class="card-body">
            <h2 class="card-title">Interests</h2>
            <label class="form-control">
              <span class="label-text">Interests (comma separated)</span>
              <input name="interests" class="input input-bordered"
                     value="<%- (currentUser?.profile?.interests || []).join(', ') %>">
            </label>

            <label class="form-control mt-3">
              <span class="label-text">Hobbies & Interests (comma separated)</span>
              <input name="hobbiesInterests" class="input input-bordered"
                     value="<%- (currentUser?.profile?.hobbiesInterests || []).join(', ') %>">
            </label>
          </div>
        </section>

        <!-- Personality (single-select/short-texts) -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-4">
            <h2 class="card-title md:col-span-2">Personality</h2>
            <% const P = currentUser?.profile || {}; %>
            <% const rows = [
              ['earlyBirdNightOwl', 'Early bird / Night owl'],
              ['stressHandling', 'Stress handling'],
              ['idealWeekend', 'Ideal weekend'],
              ['humorImportance', 'Humor importance'],
              ['plannerSpontaneous', 'Planner / Spontaneous'],
              ['favoriteMusic', 'Favorite music'],
              ['favoriteBookGenre', 'Favorite book genre'],
              ['favoriteMovieGenre', 'Favorite movie genre'],
              ['enjoyCooking', 'Enjoy cooking'],
              ['travelImportance', 'Travel importance'],
              ['stayActive', 'Stay active'],
              ['pdaComfort', 'PDA comfort'],
              ['communicationStyle', 'Communication style'],
              ['disagreementHandling', 'Disagreement handling'],
              ['loveLanguage', 'Love language'],
              ['introvertExtrovert', 'Introvert / Extrovert'],
              ['familyImportance', 'Family importance'],
              ['idealDate', 'Ideal date'],
              ['tryingNewThings', 'Trying new things'],
              ['biggestPetPeeve', 'Biggest pet peeve'],
            ]; %>

            <% rows.forEach(([name, label]) => { %>
              <label class="form-control">
                <span class="label-text"><%= label %></span>
                <input name="<%= name %>" class="input input-bordered" value="<%- P?.[name] || '' %>">
              </label>
            <% }) %>
          </div>
        </section>

        <!-- Prompts (top-level) -->
        <section class="card bg-base-100 shadow">
          <div class="card-body grid grid-cols-1 md:grid-cols-3 gap-4">
            <h2 class="card-title md:col-span-3">Prompts</h2>

            <label class="form-control">
              <span class="label-text">Favorite African Artists</span>
              <textarea name="favoriteAfricanArtists" rows="3" class="textarea textarea-bordered"><%- currentUser?.favoriteAfricanArtists || '' %></textarea>
            </label>

            <label class="form-control">
              <span class="label-text">Cultural Traditions</span>
              <textarea name="culturalTraditions" rows="3" class="textarea textarea-bordered"><%- currentUser?.culturalTraditions || '' %></textarea>
            </label>

            <label class="form-control md:col-span-1">
              <span class="label-text">Relationship Goals</span>
              <textarea name="relationshipGoals" rows="3" class="textarea textarea-bordered"><%- currentUser?.relationshipGoals || '' %></textarea>
            </label>
          </div>
        </section>

        <!-- Actions -->
        <div class="flex items-center gap-2 justify-end">
          <a href="/my-profile" class="btn btn-ghost">Cancel</a>
          <button class="btn btn-primary">Save changes</button>
        </div>
      </form>
    </main>

    <%- include('partials/footer.ejs') %>
  </body>
</html>
