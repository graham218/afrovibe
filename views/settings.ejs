<!DOCTYPE html>
<html lang="en" data-theme="afrovibe">
<%- include('partials/head.ejs', { pageTitle: 'Settings' }) %>
<body class="bg-base-100 min-h-screen flex flex-col" data-me="<%= currentUser?._id %>">
  <%- include('partials/navbar.ejs') %>

  <main class="container mx-auto p-4 flex-grow max-w-3xl">
    <h1 class="text-3xl font-bold mb-2">Account Settings</h1>
    <p class="opacity-70 mb-6">Manage your account preferences and privacy.</p>

    <!-- Quick links -->
    <div class="grid md:grid-cols-3 gap-3 mb-8">
      <a href="/settings/email" class="btn btn-block">Email Settings</a>
      <a href="/settings/password" class="btn btn-block">Password</a>
      <a href="/settings/billing" class="btn btn-block">Billing</a>
    </div>
    <!-- ... your settings page body ... -->

<!-- Buttons -->
<section class="card bg-base-100 border shadow">
  <div class="card-body">
    <h2 class="card-title">Account</h2>
    <p class="text-sm opacity-70">Deactivate (reversible) or delete (permanent) your account.</p>

    <div class="mt-3 flex gap-2">
      <button id="deactivateBtn" class="btn btn-outline">Deactivate account</button>
      <button id="deleteBtn" class="btn btn-error">Delete account</button>
    </div>
  </div>
</section>

<!-- Deactivate dialog -->
<dialog id="deactivateDialog" class="modal">
  <div class="modal-box">
    <h3 class="font-semibold text-lg">Deactivate account</h3>
    <p class="text-sm opacity-70 mt-1">Your profile will be hidden. You can log back in later to reactivate.</p>

    <form id="deactivateForm" class="mt-4">
      <label class="form-control">
        <span class="label-text">Reason (optional)</span>
        <select name="reason" class="select select-bordered">
          <option value="">Select…</option>
          <option value="break">Taking a break</option>
          <option value="found_match">Found someone</option>
          <option value="privacy">Privacy concerns</option>
          <option value="other">Other</option>
        </select>
      </label>
      <label class="form-control mt-3">
        <span class="label-text">Details (optional)</span>
        <textarea name="details" rows="3" class="textarea textarea-bordered" placeholder="Anything we should know?"></textarea>
      </label>

      <div class="mt-5 flex justify-end gap-2">
        <button type="button" class="btn btn-ghost" id="deactivateCancel">Cancel</button>
        <button type="submit" class="btn btn-outline">Deactivate</button>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop"><button>close</button></form>
</dialog>

<!-- Delete dialog -->
<dialog id="deleteDialog" class="modal">
  <div class="modal-box">
    <h3 class="font-semibold text-lg text-error">Delete account</h3>
    <p class="text-sm opacity-80 mt-1">
      This will permanently remove your profile, photos and matches. This action cannot be undone.
    </p>

    <form id="deleteForm" class="mt-4">
      <label class="form-control">
        <span class="label-text">Reason (optional)</span>
        <select name="reason" class="select select-bordered">
          <option value="">Select…</option>
          <option value="not_helpful">Didn’t find what I wanted</option>
          <option value="too_many_msgs">Too many messages</option>
          <option value="privacy">Privacy concerns</option>
          <option value="other">Other</option>
        </select>
      </label>
      <label class="form-control mt-3">
        <span class="label-text">Details (optional)</span>
        <textarea name="details" rows="3" class="textarea textarea-bordered" placeholder="Optional details…"></textarea>
      </label>

      <label class="form-control mt-4">
        <span class="label-text">Type <b>DELETE</b> to confirm</span>
        <input name="confirm" class="input input-bordered" placeholder="DELETE" />
      </label>

      <div class="mt-5 flex justify-end gap-2">
        <button type="button" class="btn btn-ghost" id="deleteCancel">Cancel</button>
        <button type="submit" class="btn btn-error">Delete permanently</button>
      </div>
    </form>
  </div>
  <form method="dialog" class="modal-backdrop"><button>close</button></form>
</dialog>

<!-- Add this ONE external script include (no inline JS needed) -->
<script src="/js/settings.js" defer></script>
  </main>

  <%- include('partials/footer.ejs') %> 
</body>
</html>
